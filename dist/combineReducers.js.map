{"version":3,"sources":["combineReducers.js"],"names":[],"mappings":";;;;;;;;2BAAkB,cAAc;;;;mCACN,sBAAsB;;;;gCACzB,mBAAmB;;;;6BACtB,gBAAgB;;;;yBAEd,WAAW;;;;yBAI1B,WAAW;;AAElB,IAAI,WAAW,YAAA;IACX,WAAW,YAAA;IACX,QAAQ,YAAA,CAAC;;;;;;AAMb,WAAW,GAAG,UAAC,GAAG,EAAK;AACnB,WAAO,8BAAM,GAAG,mCAAgB,CAAC;CACpC,CAAC;;;;;;AAMF,WAAW,GAAG,UAAC,GAAG,EAAK;AACnB,WAAO,8BAAM,GAAG,gCAAa,CAAC;CACjC,CAAC;;;;;;;;;;AAUF,QAAQ,GAAG,UAAC,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,MAAM,EAAK;AAC/C,QAAI,SAAS,YAAA,CAAC;;AAEd,QAAI,CAAC,uBAAU,QAAQ,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;AACxC,cAAM,IAAI,KAAK,qDAAqD,CAAC;KACxE;;AAED,aAAS,GAAG,MAAM,CAAC;;;AAGnB,oCAAQ,UAAU,EAAE,UAAC,KAAK,EAAE,UAAU,EAAK;;;AAGvC,YAAI,WAAW,CAAC,KAAK,CAAC,EAAE;;;AAGpB,gBAAI,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;AACpB,oBAAI,MAAM,YAAA,CAAC;;AAEX,sBAAM,CAAC,eAAe,GAAG,IAAI,CAAC;;AAE9B,sBAAM,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,MAAM,CAAC,CAAC;;AAE/D,oBAAI,CAAC,uBAAU,QAAQ,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;AACxC,0BAAM,IAAI,KAAK,8DAA4D,UAAU,kBAAa,MAAM,CAAC,IAAI,oCAA+B,OAAO,MAAM,QAAK,CAAC;iBAClK;;AAED,yBAAS,GAAG,SAAS,CAAC,GAAG,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;aACjD;SACJ,MAAM,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;AAC3B,qBAAS,GAAG,SAAS,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;SACrG;KACJ,CAAC,CAAC;;AAEH,WAAO,SAAS,CAAC;CACpB,CAAC;;;;;;;qBAMa,UAAC,OAAO,EAAK;AACxB,oCAAgB,OAAO,CAAC,CAAC;;;;;;;AAOzB,WAAO,UAAC,KAAK,EAAE,MAAM,EAAK;AACtB,YAAI,QAAQ,YAAA;YACR,MAAM,YAAA,CAAC;;AAEX,YAAI,CAAC,MAAM,EAAE;AACT,kBAAM,IAAI,KAAK,6CAA6C,CAAC;SAChE;;AAED,YAAI,MAAM,CAAC,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,OAAO,MAAM,KAAK,CAAC,EAAE;AAChD,mBAAO,CAAC,IAAI,+BAA6B,MAAM,CAAC,IAAI,oIAAiI,CAAC;;AAEtL,mBAAO,KAAK,CAAC;SAChB;;AAED,uCAAe,MAAM,CAAC,CAAC;;;;AAIvB,cAAM,GAAG;AACL,2BAAe,EAAE,KAAK;SACzB,CAAC;;AAEF,gBAAQ,GAAG,QAAQ,CAAC,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;;AAEpD,YAAI,CAAC,MAAM,CAAC,eAAe,IAAI,MAAM,CAAC,IAAI,gBAAgB,EAAE;AACxD,mBAAO,CAAC,IAAI,wBAAsB,MAAM,CAAC,IAAI,SAAM,MAAM,CAAC,CAAC;SAC9D;;AAED,eAAO,QAAQ,CAAC;KACnB,CAAC;CACL","file":"combineReducers.js","sourcesContent":["import every from 'lodash.every';\nimport isPlainObject from 'lodash.isplainobject';\nimport isFunction from 'lodash.isfunction';\nimport forEach from 'lodash.foreach';\n\nimport Immutable from 'immutable';\nimport {\n    validateReducer,\n    validateAction\n} from 'canonical';\n\nlet isActionMap,\n    isDomainMap,\n    iterator;\n\n/**\n * @param {Object.<string, Object>} map\n * @return {Boolean} If every object property value is a plain object.\n */\nisDomainMap = (map) => {\n    return every(map, isPlainObject);\n};\n\n/**\n * @param {Object.<string, Function>} map\n * @return {Boolean} If every object property value is a function.\n */\nisActionMap = (map) => {\n    return every(map, isFunction);\n};\n\n/**\n * @param {Object} domain\n * @param {Object} action\n * @param {String} action.type\n * @param {Object} collection\n * @param {Object} tapper\n * @return {Object}\n */\niterator = (domain, action, collection, tapper) => {\n    let newDomain;\n\n    if (!Immutable.Iterable.isIterable(domain)) {\n        throw new Error(`Domain must be an instance of Immutable.Iterable.`);\n    }\n\n    newDomain = domain;\n    // console.log(`domain`, domain, `action`, action, `definition`, collection);\n\n    forEach(collection, (value, domainName) => {\n        // console.log(`value`, value, `domain`, domainName, `isActionMap`, isActionMap(value), `isDomainMap`, isDomainMap(value));\n\n        if (isActionMap(value)) {\n            // console.log(`action.type`, action.type, `value[action.type]`, typeof value[action.type]);\n\n            if (value[action.type]) {\n                let result;\n\n                tapper.isActionHandled = true;\n\n                result = value[action.type](newDomain.get(domainName), action);\n\n                if (!Immutable.Iterable.isIterable(result)) {\n                    throw new Error(`Reducer must return an instance of Immutable.Iterable. \"${domainName}\" domain \"${action.type}\" action handler result is \"${typeof result}\".`);\n                }\n\n                newDomain = newDomain.set(domainName, result);\n            }\n        } else if (isDomainMap(value)) {\n            newDomain = newDomain.set(domainName, iterator(newDomain.get(domainName), action, value, tapper));\n        }\n    });\n\n    return newDomain;\n};\n\n/**\n * @param {Object} reducer\n * @return {Function}\n */\nexport default (reducer) => {\n    validateReducer(reducer);\n\n    /**\n     * @param {Immutable.Iterable} state\n     * @param {Object} action\n     * @return {Immutable.Iterable}\n     */\n    return (state, action) => {\n        let newState,\n            tapper;\n\n        if (!action) {\n            throw new Error(`Action parameter value must be an object.`);\n        }\n\n        if (action.type && action.type.indexOf(`@@`) === 0) {\n            console.info(`Ignoring private action \"${action.type}\". redux-immutable does not support state inflation. Refer to https://github.com/gajus/canonical-reducer-composition/issues/1.`);\n\n            return state;\n        }\n\n        validateAction(action);\n\n        // Tapper is an object that tracks execution of the action.\n        // @todo Make this an opt-in.\n        tapper = {\n            isActionHandled: false\n        };\n\n        newState = iterator(state, action, reducer, tapper);\n\n        if (!tapper.isActionHandled && action.type !== `CONSTRUCT`) {\n            console.warn(`Unhandled action \"${action.type}\".`, action);\n        }\n\n        return newState;\n    };\n};\n"],"sourceRoot":"/source/"}